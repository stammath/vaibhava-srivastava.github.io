<!DOCTYPE html>
<html lang="en">
<head>
    <title>Public Accounts of Canada - Data Browser</title>

    <meta charset="UTF-8">

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/dc.css"/>
	<link rel="stylesheet" type="text/css" href="css/jquery.gridster.css">
    <link rel="stylesheet" type="text/css" href="css/style.gridster.css">
    
    <link href='highlighter/shCore.css' rel='stylesheet' type='text/css'/>
    <link href='highlighter/shThemeDefault.css' rel='stylesheet' type='text/css'/>
    
    <link rel="icon" href="img/favicon.png" type="image/png" />
	<!--<link rel="shortcut icon" href="img/favicon.ico" />-->
	
	<script type="text/javascript">var switchTo5x=true;</script>
	<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
	<script type="text/javascript">stLight.options({publisher: "75357726-dca1-4b1b-88b6-be15f2bc65c3", doNotHash: true, doNotCopy: true, hashAddressBar: true});</script>
</head>
<body>

<script type="text/javascript" src="js/d3.js"></script>
<script type="text/javascript" src="js/crossfilter.js"></script>
<script type="text/javascript" src="js/dc.js"></script>
<script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="js/jquery.gridster.js" type="text/javascript" charset="utf-8"></script>


<script src='highlighter/shCore.js' type='text/javascript'></script>
<script src="highlighter/shAutoloader.js" type="text/javascript"></script>
<script src='highlighter/shBrushJScript.js' type='text/javascript'></script>
<script src='highlighter/shBrushXml.js' type='text/javascript'></script>

<a href="https://github.com/tedstrauss/expenditures"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span10">
	<h3>Public Accounts of Canada 2009-2012</h3>
	<table class="table table-bordered table-condensed">
		<thead>
			<tr>
				<th></th><th>Total authority available for use in 2009-10</th><th>Authority used in 2009-10</th><th>Total authority available for use in 2010-11</th><th>Authority used in 2010-11</th><th>Total authority available for use in 2011-12</th><th>Authority used in 2011-12</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td><strong>Voted Budgetary Expenditures</strong></td><td>$97,629,693,339</td><td>$87,471,108,577</td><td>$104,281,201,649</td><td>$92,636,171,227</td><td>$99,894,737,416</td><td>$89,717,871,421</td>
			</tr>
			<tr>
				<td><strong>Statutory Budgetay Expenditures</strong></td><td>$138,602,253,763</td><td>$137,490,030,347</td><td>$141,948,215,142</td><td>$140,358,861,908</td><td>$139,894,870,231</td><td>$138,514,961,228</td>
			</tr>
			<tr>
				<td><strong>Total Budgetary Expenditures</strong></td><td>$236,231,947,102</td><td>$224,961,138,924</td><td>$246,229,416,791</td><td>$232,995,033,135</td><td>$239,789,607,647</td><td>$228,232,832,649</td>
			</tr>
		</tbody>
	</table>
	<p>	
	<span class='st_email_hcount' displayText='Email'></span>
	<span class='st_twitter_hcount' displayText='Tweet'></span>
	<span class='st_facebook_hcount' displayText='Facebook'></span>
	<span class='st_linkedin_hcount' displayText='LinkedIn'></span>
	</p>
	<p>
	This page provides a tool for exploring the expenditures of the federal government during three fiscal year periods, 2009/10, 2010/11, 2011/12.
	The data is provided by the Treasury Board of Canada at <a href='http://www.tbs-sct.gc.ca/ems-sgd/aegc-adgc-eng.asp'>this page</a>. 
	The data here corresponds to the spreadsheet titled 'Authorities and Expenditures by vote'. A news report about the data release can
	be found <a href='http://globalnews.ca/news/502224/new-database-will-allow-canadians-to-track-government-spending-data/'>here</a>.	
	</p>
	<p><strong>How to use this tool</strong></p>
	<p>The graphs below show the distribution of the budget items across government departments, and over increasing $ amounts.
	By clicking on the charts you can filter the data, and see the list of actual budget items in the table below.
	Note that <strong>the size of the bars in the charts corresponds to the number of budget items, not the amount of dollars.</strong></p> 
	<p>In the long graph on the left side is the list of all government bodies receiving funds. 
	Click any name to filter the budget items to just that government body.</p>
	<p>The six bar charts in the center show the distribution of money spent and allocated during the three fiscal years covered.
	The horizontal axes (x-axis) show the <strong>$ amount</strong> of budget items, increasing by factors of 10, i.e. 10, 100, 1000, 10000, 100000, etc.
	The abbreviations on the x-axis are <em>k</em> thousands, <em>M</em> millions, <em>G</em> billions.
	The vertical axes (y-axis) shows the <strong>number</strong> of budget items having those values.</p> 
	<p>You can select a range on these center charts by clicking and dragging the mouse, and then slide the range around to see the values on all the charts and table update simultaneously.</p>
	<p><strong>What do you think</strong></p>
	<p>Questions or comments about this page are <a href="#comments">welcome below</a>.
	Further information about the data can be found at the <a href='http://www.tbs-sct.gc.ca/ems-sgd/aegc-adgc-eng.asp'>Treasury Board of Canada</a>.
	Notice a bug? Report it <a href='http://tedstrauss.github.io/expenditures/issues'>here</a>.
	This page was created by <a href="mailto:ted@trudat.co?Subject=Expenditures%20dashboard">Ted Strauss</a> (<a href='https://twitter.com/trudatted'>@trudatted</a>) using only wholesome ingredients <a href='http://d3js.org/'>d3.js</a>, <a href='http://nickqizhu.github.io/dc.js/'>dc.js</a>, <a href='http://square.github.io/crossfilter/'>crossfilter.js</a>, and <a href='http://gridster.net/'>gridster.js</a>. Sponsored by <a href='http://trudat.co/'>Trudat</a>.</p>
	
<h3>Data explorer</h3>
<h4>
	<div class="dc-data-count">
        <span class="filter-count"></span> selected out of <span class="total-count"></span> records | <a href="javascript:dc.filterAll(); dc.renderAll();">Reset All</a>
    </div>
</h4>
 <section class="demo">
 	<div class="gridster ready">
	      <ul>
            <li data-row="1" data-col="1" data-sizex="1" data-sizey="12">
			    <div id="org-chart">
			        <strong>Government organization</strong> (bar size indicates # of budget items)
			        <a class="reset" href="javascript:orgChart.filterAll();dc.redrawAll();" style="display: none;">reset</a>
			        <div class="clearfix"></div>
			    </div>            	
            </li>
            <li data-row="1" data-col="2" data-sizex="1" data-sizey="1">
	            <div id="spent0910">
			        Money spent during 2009-2010 (CA$)
			        <a class="reset" href="javascript:filterChart0910s.filterAll();dc.redrawAll();" style="display: none;">reset</a>
			        <div class="clearfix"></div>
			    </div>
            </li>
            <li data-row="1" data-col="3" data-sizex="1" data-sizey="1">
				<div id="avail0910">
			        Money allocated during 2009-2010 (CA$)
			        <a class="reset" href="javascript:filterChart0910a.filterAll();dc.redrawAll();" style="display: none;">reset</a>
			        <div class="clearfix"></div>
			    </div>
            </li>
            <li data-row="2" data-col="2" data-sizex="1" data-sizey="1">
				<div id="spent1011">
				        Money spent during 2010-2011 (CA$)
				        <a class="reset" href="javascript:filterChart1011s.filterAll();dc.redrawAll();" style="display: none;">reset</a>
				        <div class="clearfix"></div>
				</div>            	            	
            </li>
            <li data-row="2" data-col="3" data-sizex="1" data-sizey="1">
				<div id="avail1011">
			        Money allocated during 2010-2011 (CA$)
			        <a class="reset" href="javascript:filterChart1011a.filterAll();dc.redrawAll();" style="display: none;">reset</a>
			        <div class="clearfix"></div>
			    </div>            	
            </li>
			<li data-row="3" data-col="2" data-sizex="1" data-sizey="1">
				<div id="spent1112">
			        Money spent during 2011-2012 (CA$)
			        <a class="reset" href="javascript:filterChart1112s.filterAll();dc.redrawAll();" style="display: none;">reset</a>
			        <div class="clearfix"></div>
			    </div>            	
            </li>
            <li data-row="3" data-col="3" data-sizex="1" data-sizey="1">
			 	<div id="avail1112">
			        Money allocated during 2011-2012 (CA$)
			        <a class="reset" href="javascript:filterChart1112a.filterAll();dc.redrawAll();" style="display: none;">reset</a>
			        <div class="clearfix"></div>
			    </div>           	
            </li>
            <li data-row="4" data-col="2" data-sizex="3" data-sizey="10">
            	<div class="scrollable" style="overflow: auto;">
            		<table class="table table-hover dc-data-table">
				        <thead>
				        <tr class="header">
				        		<th>Organizations</th>	
				        		<th>Description</th>
				        		<th>Vote</th>
				        		<th>$ Allocated 2009-10</th>	
				        		<th>$ Spent 2009-10</th>	
				        		<th>$ Allocated 2010-11</th>	
				        		<th>$ Spent 2010-11</th>	
				        		<th>$ Allocated 2011-12</th>	
				        		<th>$ Spent 2011-12</th> 
				        </tr>
				        </thead>
				    </table>
			    </div>
            </li>
			<!--<li data-row="14" data-col="1" data-sizex="4" data-sizey="6">
				<div id="disqus_thread"></div>
				<a id="comments"><h3>Comments are welcome</h3></a>
				<script type="text/javascript">
				    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
				    var disqus_shortname = 'spenditures'; // required: replace example with your forum shortname
				    /* * * DON'T EDIT BELOW THIS LINE * * */
				    (function() {
				        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
				    })();
				</script>
				<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
			</li>-->
          </ul>
    </div>
</section>
</div>
<div class="span2 visible-desktop">
<img src="img/maple.png" style="position: relative; z-index:-1;"/>
</div>	
</div>
</div>
<script type="text/javascript">

var orgChart = dc.rowChart("#org-chart");
var filterChart0910a = dc.barChart("#avail0910");
var filterChart1011a = dc.barChart("#avail1011");
var filterChart1112a = dc.barChart("#avail1112");
var filterChart0910s = dc.barChart("#spent0910");
var filterChart1011s = dc.barChart("#spent1011");
var filterChart1112s = dc.barChart("#spent1112");

// set dc.js version in title
d3.selectAll("#version").text(dc.version);

// load data from a csv file
d3.csv("csv/byvote.csv", function (data) {
            // since its a csv file we need to format the data a bit
            var numberFormat = d3.format("d"); 
			var numberFormat2 = d3.format("s"); 
			var numberFormat3 = d3.format(",d"); 
			
            data.forEach(function (e, i) {
            	e.index = i;
            	e.Available_2009_10 = numberFormat(e.Available_2009_10);
            	e.Available_2010_11 = numberFormat(e.Available_2010_11);
            	e.Available_2011_12 = numberFormat(e.Available_2011_12);
            	e.Spent_2009_10 = numberFormat(e.Spent_2009_10);
            	e.Spent_2010_11 = numberFormat(e.Spent_2010_11);
            	e.Spent_2011_12 = numberFormat(e.Spent_2011_12);
            });

            // feed it through crossfilter
            var ndx = crossfilter(data);
            var all = ndx.groupAll();
			
			var a0910dim = ndx.dimension(function (d) {
				return Math.log(d.Available_2009_10) / Math.LN10;
            });
            var a0910grp = a0910dim.group(function(v) { 
            	return Math.floor(v); 
            });      		
      		var s0910dim = ndx.dimension(function (d) {
                return Math.log(d.Spent_2009_10) / Math.LN10;
            });
            var s0910grp = s0910dim.group(function(v) { 
            	return Math.floor(v); 
            });      		
			var a1011dim = ndx.dimension(function (d) {
                return Math.log(d.Available_2010_11) / Math.LN10;
            });
            var a1011grp = a1011dim.group(function(v) { 
            	return Math.floor(v); 
            });
      		var s1011dim = ndx.dimension(function (d) {
                return Math.log(d.Spent_2010_11) / Math.LN10;
            });
            var s1011grp = s1011dim.group(function(v) { 
            	return Math.floor(v); 
            });
            var a1112dim = ndx.dimension(function (d) {
                return Math.log(d.Available_2011_12) / Math.LN10;
            });
            var a1112grp = a1112dim.group(function(v) { 
            	return Math.floor(v); 
            });
      		var s1112dim = ndx.dimension(function (d) {
                return Math.log(d.Spent_2011_12) / Math.LN10;
            });
            var s1112grp = s1112dim.group(function(v) { 
            	return Math.floor(v); 
            });
      		var organization_dim = ndx.dimension(function (d) {
                return d.Organizations;
            });
            var organization_grp = organization_dim.group();
      		
      		var description_dim = ndx.dimension(function (d) {
                return d.Description;
            });
      		var vote_dim = ndx.dimension(function (d) {
                return d.Vote;
            });
      		
      		orgChart.width(280) // (optional) define chart width, :default = 200
			    .height(2200) // (optional) define chart height, :default = 200
			    .dimension(organization_dim) // set dimension
			    .group(organization_grp) // set group
			    .margins({top: 20, left: 10, right: 10, bottom: 20})
			    .colors(['#D462FF', '#736AFF', '#92C7C7', '#595454', '#E3319D', '#FF00FF', '#666362', '#E56E94', '#3090C7', '#8B31C7', '#C8BBBE', '#342D7E', '#646060', '#2554C7', '#E238EC', '#1569C7', '#CFECEC', '#544E4F', '#728FCE', '#3EA99F', '#7F38EC', '#737CA1', '#7D0541', '#8EEBEC', '#736F6E', '#4C4646', '#6A287E', '#565051', '#46C7C7', '#F6358A', '#1589FF', '#7FFFD4', '#810541', '#38ACEC', '#4A4344', '#3BB9FF', '#4E4848', '#9AFEFF', '#C031C7', '#2B60DE', '#B93B8F', '#6D7B8D', '#15317E', '#8467D7', '#737CA1', '#41627E', '#EBDDE2', '#4863A0', '#5F5A59', '#BDEDFF', '#C6DEFF', '#504A4B', '#667C26', '#726E6D', '#348781', '#48CCCD', '#7E587E', '#307D7E', '#6698FF', '#306EFF', '#153E7E', '#357EC7', '#646D7E', '#AFDCEC', '#254117', '#A23BEC', '#CA226B', '#50EBEC', '#C12283', '#4E9258', '#B7CEEC', '#B4CFEC', '#F0F8FF', '#347235', '#E9CFEC', '#E4287C', '#FCDFFF', '#95B9C7', '#157DEC', '#6D6968', '#6960EC', '#41383C', '#78c7c7', '#7D053F', '#6E6A6B', '#F535AA', '#79BAEC', '#C6AEC7', '#D2B9D3', '#B048B5', '#7D1B7E', '#87AFC7', '#2B3856', '#56A5EC', '#657383', '#82CAFF', '#488AC7', '#F9B7FF', '#F52887', '#747170', '#F433FF', '#9172EC', '#F6358A', '#43C6DB', '#57FEFF', '#52F3FF', '#82CAFA', '#25587E', '#43BFC7', '#6C2DC7', '#616D7E', '#4C7D7E', '#F0FFFF', '#617C58', '#566D7E', '#8D38C9', '#7D0552', '#B041FF', '#C45AEC', '#306754', '#98AFC7', '#347C2C', '#151B54', '#4E387E', '#2B547E', '#A0CFEC', '#806D7E', '#717D7D', '#800517', '#00FFFF', '#E4317F', '#696565', '#461B7E', '#5E7D7E', '#D16587', '#2B65EC', '#463E3F', '#4EE2EC', '#E3E4FA', '#ADDFFF', '#FDEEF4', '#5E767E', '#4C787E', '#387C44', '#E0FFFF', '#5E5A80', '#C38EC7', '#C2DFFF', '#893BFF', '#7A5DC7', '#C12869', '#4E8975', '#463E41', '#571B7E', '#8E35EF', '#151B8D', '#842DCE', '#F778A1', '#E6A9EC', '#77BFC7', '#625D5D', '#659EC7', '#9E7BFF', '#25383C', '#C25A7C', '#3B9C9C', '#5CB3FF', '#A74AC7', '#7E354D', '#5C5858', '#AFC7C7', '#C12267'])
			    .gap(1)
			    .renderLabel(true)
			    .renderTitle(true)
			    .xAxis().ticks(4);
			 filterChart0910a.width(300)
                    .height(180)
                    .margins({top: 10, right: 50, bottom: 30, left: 40})
                    .dimension(a0910dim)
                    .group(a0910grp)
                    .elasticY(true)
                    .centerBar(true)
                    .gap(3)
                    .round(dc.round.floor)
                    .x(d3.scale.linear().domain([0,11])) 
                    .renderHorizontalGridLines(true)
                    .xAxis()
                    .tickFormat(function (v) {
                        return numberFormat2(Math.pow(10,v));
                    });
             filterChart0910s.width(300)
                    .height(180)
                    .margins({top: 10, right: 50, bottom: 30, left: 40})
                    .dimension(s0910dim)
                    .group(s0910grp)
                    .elasticY(true)
                    .centerBar(true)
                    .gap(3)
                    .round(dc.round.floor)
                    .x(d3.scale.linear().domain([0,11])) 
                    .renderHorizontalGridLines(true)
                    .xAxis()
                    .tickFormat(function (v) {
                        return numberFormat2(Math.pow(10,v));
                    });
              filterChart1011a.width(300)
                    .height(180)
                    .margins({top: 10, right: 50, bottom: 30, left: 40})
                    .dimension(a1011dim)
                    .group(a1011grp)
                    .elasticY(true)
                    .centerBar(true)
                    .gap(3)
                    .round(dc.round.floor)
                    .x(d3.scale.linear().domain([0,11])) 
                    .renderHorizontalGridLines(true)
                    .xAxis()
                    .tickFormat(function (v) {
                        return numberFormat2(Math.pow(10,v));                        
                    });
             filterChart1011s.width(300)
                    .height(180)
                    .margins({top: 10, right: 50, bottom: 30, left: 40})
                    .dimension(s1011dim)
                    .group(s1011grp)
                    .elasticY(true)
                    .centerBar(true)
                    .gap(3)
                    .round(dc.round.floor)
                    .x(d3.scale.linear().domain([0,11])) 
                    .renderHorizontalGridLines(true)
                    .xAxis()
                    .tickFormat(function (v) {
                        return numberFormat2(Math.pow(10,v));
                    });    
             filterChart1112a.width(300)
                    .height(180)
                    .margins({top: 10, right: 50, bottom: 30, left: 40})
                    .dimension(a1112dim)
                    .group(a1112grp)
                    .elasticY(true)
                    .centerBar(true)
                    .gap(3)
                    .round(dc.round.floor)
                    .x(d3.scale.linear().domain([0,11])) 
                    .renderHorizontalGridLines(true)
                    .xAxis()
                    .tickFormat(function (v) {
                        return numberFormat2(Math.pow(10,v));
                    });
             filterChart1112s.width(300)
                    .height(180)
                    .margins({top: 10, right: 50, bottom: 30, left: 40})
                    .dimension(s1112dim)
                    .group(s1112grp)
                    .elasticY(true)
                    .centerBar(true)
                    .gap(3)
                    .round(dc.round.floor)
                    .x(d3.scale.linear().domain([0,11])) 
                    .renderHorizontalGridLines(true)
                    .xAxis()
                    .tickFormat(function (v) {
                        return numberFormat2(Math.pow(10,v));
                    });        
            
            dc.dataCount(".dc-data-count")
                    .dimension(ndx)
                    .group(all);

            dc.dataTable(".dc-data-table")
                    .dimension(description_dim)
                    .group(function (d) {
                        return d.Organizations;
                    })
                    .size(600)
                    .columns([
                    	function (d) {
                            return d.Organizations;
                        },
                        function (d) {
                            return d.Description;
                        },
                        function (d) {
                            return d.Vote;
                        },
                        function (d) {
                            return numberFormat3(d.Available_2009_10);
                        },
                        function (d) {
                            return numberFormat3(d.Spent_2009_10);
                        },
                        function (d) {
                            return numberFormat3(d.Available_2010_11);
                        },
                        function (d) {
                            return numberFormat3(d.Spent_2010_11);
                        },
                        function (d) {
                            return numberFormat3(d.Available_2011_12);
                        },
                        function (d) {
                            return numberFormat3(d.Spent_2011_12);
                        }	
                    ])
                    .sortBy(function (d) {
                        return d.Organizations;
                    })
                    .order(d3.ascending)
                    .renderlet(function (table) {
                        table.selectAll(".dc-table-group").classed("info", true);
                    });

            dc.renderAll();
            }
		);
		
		var gridster;
		  $(function(){
		    gridster = $(".gridster > ul").gridster({
		        widget_margins: [4, 4],
		        widget_base_dimensions: [320, 200],
		        min_cols: 4
		    }).data('gridster').disable();
		
		  });
</script>

<!--<script src="http://code.jquery.com/jquery-latest.js"></script>-->
<script src="js/bootstrap.min.js"></script>

<script type="text/javascript">
    SyntaxHighlighter.all();
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-18477261-6', 'spenditures.ca');
  ga('send', 'pageview');

</script>
</body>
</html>
